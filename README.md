# BlockZ

一个旨在为 Minecraft 1.20.1 带来硬核生存体验的模组，深度致敬 DayZ 与 DayM。

**当前版本**: 1.1-Alpha

## 🌟 核心功能

### 1. 全新的 DayZ 风格 GUI
- **三面板布局**：左侧为“附近物品 (VICINITY)”，中间为“玩家状态 (PLAYER)”，右侧为“物品栏 (INVENTORY)”。
- **附近物品系统**：实时检测玩家周围 2.0 格范围内的掉落物，支持直接点击拾取或拖拽丢弃。
- **拖拽丢弃**：将物品拖拽到 Vicinity 区域即可直接丢弃到世界中。
- **界面切换**：支持通过按键或命令 `/blockz_toggle_ui` 在 DayZ 风格界面与原版界面之间切换。

### 2. 动态背包与锁定系统
- **独立容器**：背包不再是简单的格子扩展，每个背包物品都有独立的 NBT 储存空间。
- **动态槽位**：根据装备的背包等级（小、中、大）动态开启对应的存储格。
- **原版背包锁定**：
  - 在关闭 DayZ UI (使用原版界面) 时，非管理员玩家的背包空间将被限制为基础 5 格。
  - **可配置开关**：此功能可以通过配置文件 `blockz-common.toml` 中的 `ui.enable_vanilla_lock` 开启或关闭（默认开启）。
  - 只有穿戴了特定的含口袋装备（如战术背心、口袋衣物）才能解锁额外空间。
  - 未解锁的区域将显示红色的“锁定”图标，且无法放入物品。
  - 锁定机制通过底层 Mixin 强力实现，防止任何绕过手段。

### 3. DayZ 风格 HUD
- **状态图标**：生命值、饥饿值、饮水度（开发中）与护甲值。
- **填充式显示**：图标会随着数值的变化而上下填充，直观反馈玩家状态。
- **极简设计**：在非聊天界面下自动优化显示效果，保持屏幕整洁。

### 4. 性能优化
- **智能扫描**：Vicinity 检测采用每 0.5 秒一次的智能扫描，显著降低大量掉落物时的 CPU 开销。
- **渲染优化**：合并渲染状态切换，保证在各种配置下都能维持稳定的帧数。

## 📖 使用教程

### 1. 基础操作
- **打开背包**：按 `E` 键打开 DayZ 风格背包（默认）。
- **切换界面**：如果不习惯 DayZ 风格，可以输入命令 `/blockz_toggle_ui` 切换回原版 Minecraft 界面。
- **拾取物品**：
  - **Vicinity 面板**（左侧）：显示周围地上的物品，点击即可捡起。
  - **拖拽**：将物品从 Vicinity 拖到背包中，或从背包拖到 Vicinity 丢弃。

### 2. 背包扩容指南
本模组采用了硬核的背包容量限制：
- **初始状态**：你只有 5 个基础口袋槽位（对应原版快捷栏上方的一小行）。
- **如何扩容**：
  - 寻找并装备 **背包 (Backpack)**：提供大量存储空间。
  - 寻找并装备 **战术背心 (Vest)**：提供中等存储空间。
  - 穿戴 **口袋衣物**：部分衣物提供少量额外槽位。
- **锁定机制**：未解锁的槽位会被红色锁定图标覆盖，无法使用。即使切换回原版 UI，这些限制依然存在（除非在配置中关闭）。

### 3. 配置说明
配置文件位于 `.minecraft/config/blockz-common.toml`：
```toml
[ui]
    # UI 缩放比例 (0.5 - 2.0)
    "ui.scale" = 1.0
    # 允许玩家使用命令切换 UI 风格
    "ui.allow_player_toggle" = true
    # 启用原版背包锁定机制 (关闭后原版界面将不再限制槽位)
    "ui.enable_vanilla_lock" = true
```

### 4. 常见问题
- **Q: 为什么我的背包只有一排格子能用？**
  - A: 这是模组的设定。你需要寻找背包或背心来解锁更多空间。
- **Q: 锁定图标变紫了/没贴图？**
  - A: 请检查资源包加载情况，确保 mod 版本正确。

### 5. 自定义与其他模组兼容
本模组支持通过配置文件为其他模组的物品定义 **网格尺寸** 和 **背包容量**。

1. **配置文件位置**：
   `.minecraft/config/blockz/grid_items.json`

2. **配置格式**：
   在 `items` 对象中添加键值对。键为物品 ID (如 `minecraft:diamond_sword`)，值为配置对象。

   | 字段 | 类型 | 说明 |
   | :--- | :--- | :--- |
   | `width` | 整数 | 物品在 DayZ 物品栏中占用的宽度 (1-20) |
   | `height` | 整数 | 物品在 DayZ 物品栏中占用的高度 (1-20) |
   | `slots` | 整数 | (可选) 如果该物品是背包/衣物，提供的额外槽位数 |

3. **示例**：
   假设你想兼容 "Another Mod" 的 "Big Bag"，让它占 3x3 格子并提供 30 个背包槽位：
   ```json
   {
     "items": {
       "another_mod:big_bag": {
         "width": 3,
         "height": 3,
         "slots": 30
       },
       "another_mod:long_sword": {
         "width": 1,
         "height": 4
       }
     }
    }
    ```
    *修改配置文件后，无需重启游戏，使用命令 `/blockz_reload` 即可生效。*

### 6. 物品指南
#### 背包与扩容装备
以下装备可以为你提供额外的背包槽位（具体数值可在配置中修改）：

| 物品名称 | 默认提供槽位 | 说明 |
| :--- | :---: | :--- |
| **Coyote Backpack (土狼背包)** | 24 | 大容量军用背包 |
| **Alice Backpack (爱丽丝背包)** | 20 | 经典军用背包 |
| **Czech Backpack (捷克背包)** | 16 | 中型背包 |
| **Patrol Pack (巡逻包)** | 8 | 轻便型背包 |
| **Czech Pouch (捷克挂包)** | 6 | 小型挂包 |
| **Vest (战术背心)** | 12 | 装备在背心槽，可与背包叠加 |

#### 衣物系统
BlockZ 的衣物不仅仅是装饰，它们也能提供少量的存储空间（口袋）：
- **Shirt (上衣)**：默认提供 **6** 个槽位。
- **Pants (裤子)**：默认提供 **4** 个槽位。
- **提示**：即使没有背包，穿上一套好衣服也能让你多带几组弹药或绷带。

### 7. 联动模组说明
本模组设计用于与以下类型的模组协同工作以获得最佳体验：
- **枪械模组** (如 Vic's Point Blank, TaC): DayZ 风格界面非常适合现代战争生存。
- **⚠ 真实生存模组推荐**：强烈推荐搭配 **Thirst Was Taken** 使用！本模组已针对其饮水系统进行了深度适配，能带来最完整的生存体验。
- **JEI (Just Enough Items)**: 强烈建议安装，以便查看合成配方（虽然本模组物品多为搜刮获得）。
- **Curios API**: (计划中) 未来将支持更多饰品栏位扩展。

## 🛠️ 技术架构 (Forge 1.20.1)
- **Capability 系统**：使用 Forge Capability 持久化存储玩家的背包装备状态。
- **网络通信**：自定义 S2C 数据包确保客户端与服务器之间的背包状态实时同步。
- **自定义菜单系统**：深度定制 `AbstractContainerMenu` 以实现复杂的槽位交互逻辑。
- **Mixin 注入**：修改底层 `Slot` 逻辑以实现严格的物品锁定。

## 📂 项目结构
- `com.yitianys.BlockZ.menu`: 核心物品栏逻辑
- `com.yitianys.BlockZ.client.gui`: 自定义界面渲染
- `com.yitianys.BlockZ.client.hud`: HUD 覆盖层实现
- `com.yitianys.BlockZ.capability`: 玩家属性扩展
- `com.yitianys.BlockZ.network`: 网络通信包
- `com.yitianys.BlockZ.mixin`: 底层逻辑修改

---
*注：本模组目前处于 Alpha 开发阶段。*
## 💰  赞助作者
![求赞助](https://github.com/yitian77/BlockZ/blob/master/2.jpg)
![求赞助](https://github.com/yitian77/BlockZ/blob/master/1.jpg)
